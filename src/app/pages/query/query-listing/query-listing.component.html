<div class="content-wrapper">
    <!-- Content -->
    <div class="container-xxl flex-grow-1 container-p-y">
        <div class="row">
            <h4 class="fw-bold col-md-10"><span class="text-muted fw-light">Queries /</span> Queries Listing <span class="text-muted">({{totalQueries}})</span></h4> 
            <a *ngIf="this.userRole =='1' || this.userRole =='2' " routerLink="/add-query" class="btn btn-primary col-md-2">Add new Query</a>
        </div>
        <div class="accordion mt-3 mb-3" id="accordionExample">
            <div class="card accordion-item">
                <h2 class="accordion-header" id="headingThree">
                    <button type="button" class="accordion-button collapsed" data-bs-toggle="collapse" data-bs-target="#accordionThree" aria-expanded="false" aria-controls="accordionThree">
                        <h4><strong>Apply Filters</strong></h4>
                    </button>
                </h2>
            <div id="accordionThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample" >
                <div class="accordion-body">
                    <div class="row mb-2">
                        <div class="col-md-2">
                            <label for="defaultFormControlInput" class="form-label">Created From</label>
                            <input type="date" (change)="updateFilterData('created_from', created_from.value)" #created_from class="form-control" id="defaultFormControlInput" aria-describedby="defaultFormControlHelp" />
                        </div>
                        <div class="col-md-2">
                            <label for="defaultFormControlInput" class="form-label">Created To</label>
                            <input type="date" (change)="updateFilterData('created_to', created_to.value)" #created_to class="form-control" id="defaultFormControlInput" aria-describedby="defaultFormControlHelp" />
                        </div>
                        <div class="col-md-2">
                            <label for="defaultFormControlInput" class="form-label">Update From</label>
                            <input type="date" (change)="updateFilterData('updated_from', updated_from.value)" #updated_from class="form-control" id="defaultFormControlInput" aria-describedby="defaultFormControlHelp" />
                        </div>
                        <div class="col-md-2">
                            <label for="defaultFormControlInput" class="form-label">Update To</label>
                            <input type="date" (change)="updateFilterData('updated_to', updated_to.value)" #updated_to class="form-control" id="defaultFormControlInput" aria-describedby="defaultFormControlHelp" />
                        </div>
                        <div class="col-md-2">
                            <label for="defaultFormControlInput" class="form-label">Search By ID</label>
                            <input type="text" placeholder="ID No." (change)="updateFilterData('search_by_id', search_by_id.value)" #search_by_id class="form-control" id="defaultFormControlInput" aria-describedby="defaultFormControlHelp" />
                        </div>
                        <div class="col-md-2">
                            <label for="defaultFormControlInput" class="form-label">Status</label>
                            <select class="form-select" (change)="updateFilterData('status', status.value)" #status>
                                <option value="">All</option>
                                <option value="new">New</option>
                                <option value="interested">Interested</option>
                                <option value="hot">Hot</option>
                                <option value="not_interested">Not Interested</option>
                                <option value="converted">Converted</option>
                                <option value="closed">Closed</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <label for="defaultFormControlInput" class="form-label">Search By - Name, Email, Mobile</label>
                            <input type="text" placeholder="Name | Email | Mobile" (change)="updateFilterData('search_by_name_email_mobile', search_by_name_email_mobile.value)" #search_by_name_email_mobile class="form-control" id="defaultFormControlInput" aria-describedby="defaultFormControlHelp" />
                        </div>
                        <div class="col-md-3">
                            <label for="defaultFormControlInput" class="form-label">Destination</label>

                            <select class="form-select" (change)="updateFilterData('destination', destination.value)" #destination>
                                <option value="">All Destinations</option>
                                <option *ngFor="let destination of destinationList" value="{{destination.id}}">{{destination.name}}</option>
                            </select>
                        </div>
                        <div class="col-md-2" *ngIf="this.userRole =='1' || this.userRole =='2' ">
                            <label for="defaultFormControlInput" class="form-label">Assigned To</label>
                            <select class="form-select" (change)="updateFilterData('assigned_to', assigned_to.value)" #assigned_to>
                                <option value="">All</option>
                                <option *ngFor="let user of users"  value="{{user.id}}">{{user.name}}</option>
                            </select>
                        </div>
                        <div class="col-md-2" *ngIf="this.userRole =='1' || this.userRole =='2' ">
                            <label for="defaultFormControlInput" class="form-label">Source</label>
                            <select class="form-select" (change)="updateFilterData('source', source.value)" #source>
                                <option value="">All</option>
                                <option value="Facebook">Facebook</option>
                                <option value="Instagram">Instagram</option>
                                <option value="Advertisement">Advertisement</option> <!-- Note: Fixed spelling from "Advertisiment" -->
                                <option value="Networking">Networking</option>
                                <option value="Walk In">Walk In</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label for="defaultFormControlInput" class="form-label">Clear All</label>
                            <button (click)="removeFilters()" class="form-control btn btn-danger"><strong>Remove Filters</strong></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card mb-4">
        <div class="table-responsive text-nowrap">
            <table class="table table-hover text-center">
                <div class="container">

                </div>
                <thead>
                    <tr>
                        <th>Query Details</th>
                        <th>Client Details</th>
                        <th>Tour Details</th>
                        <th>Query Status</th>
                        <th>Dates</th>
                    </tr>
                </thead>
                <tbody class="table-border-bottom-0">
                    <tr *ngFor="let query of queries">
                        <td>
                            <strong>{{query.id}}</strong><br><br>
                            <p class="badge bg-label-primary me-1">{{query.status}}</p><br>
                            <span class="badge bg-label-warning me-1">{{query.source}}</span>
                        </td>
                        <td class="lh-2">
                            <span class=""><strong>{{query.title}} {{query.name}}</strong></span><br>
                            <span><img src="assets/img/icons/custom/mobile.webp" height=12 alt=""> {{query.mobile}}</span>
                            <p><img src="assets/img/icons/custom/mail.png" height=10 alt=""> {{query.email}}</p>
                            <span>{{query.adult_count}} Adult, {{query.child_count}} Child, {{query.infant_count}} Infant</span>
                        </td>
                        <td style="width: 150px;">
                            <strong class="text-secondary">{{query.destinations}}</strong><br><br>
                            <span><img src="assets/img/icons/custom/date.png" height=15 alt=""><strong class="text-primary"> Check In: </strong>{{dateFormat(query.from_date)}}</span><br>
                            <span><img src="assets/img/icons/custom/date.png" height=15 alt=""><strong class="text-primary"> Check Out: </strong>{{dateFormat(query.to_date)}}</span><br><br>
                        </td>
                        <td>
                            <p><strong class="text-dark">Priority : </strong><span class="badge bg-label-danger me-1">{{query.priority}}</span></p>
                            <span><strong class="text-dark">Assign To : </strong><span>{{query.assign_to.name}}</span></span>
                            <p><span class="badge bg-label-primary me-1">{{query.assign_to.email}}</span></p>
                        </td>
                        <td>
                            <p><strong class="text-dark">Created On : </strong><span>{{dateFormat(query.created_on)}}</span></p>
                            <p><strong class="text-dark">Updated On : </strong><span>{{dateFormat(query.updated_on)}}</span></p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            <li class="page-item prev">
                <a class="page-link" (click)="this.pageChange('-')" href="javascript:void(0);"><i class="tf-icon bx bx-chevrons-left"></i></a>
            </li>
            
            <li *ngFor="let pageNum of [].constructor(lastPage); let i = index" 
                [class.active]="page === (i + 1)" 
                class="page-item">
                <a class="page-link" (click)="pageChange(i + 1)" href="javascript:void(0);">{{ i + 1 }}</a>
            </li>

            <li class="page-item next">
                <a class="page-link" (click)="this.pageChange('+')" href="javascript:void(0);"><i class="tf-icon bx bx-chevrons-right"></i></a>
            </li>
        </ul>
    </nav>
</div>